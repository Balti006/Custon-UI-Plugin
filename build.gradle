plugins {
    id "com.bertramlabs.asset-pipeline" version "3.3.2"
    id "com.github.johnrengelman.shadow" version "2.0.3"
}
group = 'org.springframework.integration'
apply plugin: 'java'
apply plugin: 'groovy'
apply plugin: 'maven-publish'

group = 'com.morpheusdata'
version = '1.0.0'

sourceCompatibility = '1.11'
targetCompatibility = '1.11'

ext.isReleaseVersion = !version.endsWith("SNAPSHOT")

repositories {
    mavenCentral()
}

configurations {

        integTestCompile.extendsFrom testCompile
        integTestRuntime.extendsFrom testRuntime

    provided
}

dependencies {
    compileOnly 'com.morpheusdata:morpheus-plugin-api:0.12.5' //use 0.13.4 for 5.5.x
    compileOnly 'org.codehaus.groovy:groovy-all:3.0.9'
    compileOnly 'io.reactivex.rxjava2:rxjava:2.2.0'
    compileOnly 'org.slf4j:slf4j-api:1.7.26'
    compileOnly 'org.slf4j:slf4j-parent:1.7.26'
}

jar {
    manifest {
        attributes(
                'Plugin-Class': 'com.morpheusdata.consul.ConsulIntegrationPlugin', //Reference to Plugin class
                'Plugin-Version': archiveVersion.get() // Get version defined in gradle
        )
    }
}
tasks.assemble.dependsOn tasks.shadowJar